window.productosBase = [
  {
    id: 21,
    nombre: "Nike SB Dunk Low Pro",
    precio: 120000,
    imagen: "img/dunk-low-pro.png",
    descripcion: "Siempre puedes contar con un clasico. Los Dunk Low combinan un estilo Color Block iconico con materiales premium y un acolchado suave para ofrecer una comodidad revolucionaria. Las posibilidades son infinitas. Como vas a usar tus Dunk?\n\nBeneficios:\n- La parte superior de cuero se suaviza y adquiere un caracter vintage con el uso.\n- La amortiguacion Air Zoom brinda un rapido despegue.\n- La suela de goma con el punto de pivote clasico aporta traccion duradera y un estilo de herencia.\n\nDatos del producto:\nCuello acolchado\nEntresuela de espuma\nColor que se muestra: Rojo team oscuro/Chaleco oliva/Beige paracaidas/Burdeos energico\nEstilo: HQ1625-600"
  },
  {
    id: 1,
    nombre: "Air Jordan 3 Retro Black Cat",
    precio: 280000,
    imagen: "https://newcop.com/cdn/shop/files/01_ff7c9471-f6f5-470f-960b-08a527f6e8bf.png?height=600&v=1736528666"
  },
  {
    id: 2,
    nombre: "Adidas Campus 00S",
    precio: 94990,
    imagen: "https://newcop.com/cdn/shop/files/adidas-campus-00s-core-black-1_2000x_f891c99f-d7be-41e6-aa92-9000abde32d0.webp?v=1682784882"
  },
  {
    id: 3,
    nombre: "Nike Air Max 97",
    precio: 159990,
    imagen: "https://static.nike.com/a/images/t_PDP_864_v1/f_auto,b_rgb:f5f5f5/6a3671b8-f115-44f6-9ab6-3798d55210eb/custom-nike-air-max-97-shoes-by-you.png"
  },
  {
    id: 12,
    nombre: "Puma Suede Classic",
    precio: 69990,
    imagen: "https://images.puma.com/image/upload/f_auto,q_auto,b_rgb:fafafa,w_600,h_600/global/352634/03/sv01/fnd/PNA/fmt/png/PUMA-Suede-Classic"
  },
  {
    id: 13,
    nombre: "Reebok Club C 85",
    precio: 74990,
    imagen: "https://cdn-images.farfetch-contents.com/23/10/69/09/23106909_53297455_2048.jpg"
  },
  {
    id: 14,
    nombre: "New Balance 327",
    precio: 99990,
    imagen: "https://nb.scene7.com/is/image/NB/ms327cp_nb_02_i?$pdpflexf2$&wid=440&hei=440"
  },
  {
    id: 15,
    nombre: "Fila Disruptor II",
    precio: 64990,
    imagen: "https://fila.scene7.com/is/image/FilaUSA/5FM00553_125_01?$pdpflexf2$&wid=440&hei=440"
  },
  {
    id: 16,
    nombre: "Under Armour HOVR Phantom",
    precio: 139990,
    imagen: "https://underarmour.scene7.com/is/image/Underarmour/3022586-001_DEFAULT?wid=600&hei=600"
  },
  {
    id: 17,
    nombre: "Asics Gel-Lyte III",
    precio: 109990,
    imagen: "https://asics.scene7.com/is/image/asics/1191A266_020_SR_RT_GLB?$zoom$"
  },
  {
    id: 18,
    nombre: "Saucony Jazz Original Vintage",
    precio: 89990,
    imagen: "https://saucony.scene7.com/is/image/Saucony/2044-524_V_01?wid=600&hei=600"
  },
  {
    id: 19,
    nombre: "Mizuno Wave Rider 25",
    precio: 129990,
    imagen: "https://mizuno.scene7.com/is/image/Mizuno/411319_90_01?wid=600&hei=600"
  },
  {
    id: 20,
    nombre: "Jordan 1 Mid SE",
    precio: 179990,
    imagen: "https://static.nike.com/a/images/t_PDP_864_v1/f_auto,b_rgb:f5f5f5/6a3671b8-f115-44f6-9ab6-3798d55210eb/jordan-1-mid-se-shoes.png"
  },
  {
    id: 4,
    nombre: "Puma RS-X",
    precio: 89990,
    imagen: "https://images.puma.com/image/upload/f_auto,q_auto,b_rgb:fafafa,w_600,h_600/global/369666/01/sv01/fnd/PNA/fmt/png/PUMA-RS-X"
  },
  {
    id: 5,
    nombre: "New Balance 550",
    precio: 119990,
    imagen: "https://nb.scene7.com/is/image/NB/m550sgw_nb_02_i?$pdpflexf2$&wid=440&hei=440"
  },
  {
    id: 6,
    nombre: "Converse Chuck Taylor All Star",
    precio: 59990,
    imagen: "https://www.converse.cl/media/catalog/product/cache/1/image/1200x/040ec09b1e35df139433887a97daa66f/1/0/100200_1.jpg"
  },
  {
    id: 7,
    nombre: "Vans Old Skool",
    precio: 64990,
    imagen: "https://images.vans.com/is/image/VansBrand/A4BV5BLK-HERO?wid=800&hei=800&fmt=png-alpha"
  },
  {
    id: 8,
    nombre: "Reebok Classic Leather",
    precio: 69990,
    imagen: "https://assets.reebok.com/images/w_600,f_auto,q_auto/0c7e2e2e7e2e4e2e8e2e8e2e8e2e8e2e_9366/Reebok_Classic_Leather_Shoes_White_GY0955_01_standard.jpg"
  },
  {
    id: 9,
    nombre: "Air Jordan 4RM",
    precio: 82990,
    imagen: "https://nikeclprod.vtexassets.com/arquivos/ids/1385195-800-800?v=638882123132930000&width=800&height=800&aspect=true",
    descripcion: "Las zapatillas Jordan Air 4 RM están diseñadas para acompañarte en cada paso de tu vida activa. Estas icónicas zapatillas son fácilmente reconocibles y se centran en ofrecer la máxima comodidad y durabilidad, sin sacrificar ese estilo tradicional que tanto amas. Con tecnología Max Air en el talón, cada pisada se siente amortiguada y ligera. La parte superior, que combina elementos como el ala, el ojal y el talón, crea una estructura resistente y flexible que abraza tu pie, asegurando que estés listo para cualquier aventura en tu día a día. ¡Prepárate para moverte con estilo y confianza!"
  }
];

// Si algún producto no tiene imagen, le ponemos una por defecto para que siempre se vea bien en la tienda
for (let producto of window.productosBase) {
  if (!producto.imagen || producto.imagen === "") {
    producto.imagen = "img/default-shoe.png";
  }
}


renderProductosDestacados();

window.addEventListener("storage", function(e) {
  if (e.key === "productos") renderProductosDestacados();
});

// Cuando el usuario agrega un producto al carrito, lo sumamos y actualizamos el localStorage
function agregarCarrito(id, nombre, precio, imagen) {
  const productosIniciales = [
    {
      id: 1,
      nombre: "Air Jordan 3 Retro Black Cat",
      precio: 280000,
      imagen: "https://newcop.com/cdn/shop/files/01_ff7c9471-f6f5-470f-960b-08a527f6e8bf.png?height=600&v=1736528666"
    },
    {
      id: 2,
      nombre: "Adidas Campus 00S",
      precio: 94990,
      imagen: "https://newcop.com/cdn/shop/files/adidas-campus-00s-core-black-1_2000x_f891c99f-d7be-41e6-aa92-9000abde32d0.webp?v=1682784882"
    },
    {
      id: 3,
      nombre: "Nike Air Max 97",
      precio: 159990,
      imagen: "https://static.nike.com/a/images/t_PDP_864_v1/f_auto,b_rgb:f5f5f5/6a3671b8-f115-44f6-9ab6-3798d55210eb/custom-nike-air-max-97-shoes-by-you.png"
    },
    {
      id: 4,
      nombre: "Puma RS-X",
      precio: 89990,
      imagen: "https://images.puma.com/image/upload/f_auto,q_auto,b_rgb:fafafa,w_600,h_600/global/369666/01/sv01/fnd/PNA/fmt/png/PUMA-RS-X"
    },
    {
      id: 5,
      nombre: "New Balance 550",
      precio: 119990,
      imagen: "https://nb.scene7.com/is/image/NB/m550sgw_nb_02_i?$pdpflexf2$&wid=440&hei=440"
    },
    {
      id: 6,
      nombre: "Converse Chuck Taylor All Star",
      precio: 59990,
      imagen: "https://www.converse.cl/media/catalog/product/cache/1/image/1200x/040ec09b1e35df139433887a97daa66f/1/0/100200_1.jpg"
    },
    {
      id: 7,
      nombre: "Vans Old Skool",
      precio: 64990,
      imagen: "https://images.vans.com/is/image/VansBrand/A4BV5BLK-HERO?wid=800&hei=800&fmt=png-alpha"
    },
    {
      id: 8,
      nombre: "Reebok Classic Leather",
      precio: 69990,
      imagen: "https://assets.reebok.com/images/w_600,f_auto,q_auto/0c7e2e2e7e2e4e2e8e2e8e2e8e2e8e2e_9366/Reebok_Classic_Leather_Shoes_White_GY0955_01_standard.jpg"
    },
    {
      id: 9,
      nombre: "Air Jordan 4RM",
      precio: 82990,
      imagen: "https://nikeclprod.vtexassets.com/arquivos/ids/1385195-800-800?v=638882123132930000&width=800&height=800&aspect=true",
      descripcion: "Las zapatillas Jordan Air 4 RM están diseñadas para acompañarte en cada paso de tu vida activa. Estas icónicas zapatillas son fácilmente reconocibles y se centran en ofrecer la máxima comodidad y durabilidad, sin sacrificar ese estilo tradicional que tanto amas. Con tecnología Max Air en el talón, cada pisada se siente amortiguada y ligera. La parte superior, que combina elementos como el ala, el ojal y el talón, crea una estructura resistente y flexible que abraza tu pie, asegurando que estés listo para cualquier aventura en tu día a día. ¡Prepárate para moverte con estilo y confianza!"
    }
  ];

  let productos = JSON.parse(localStorage.getItem("productos"));
  const idsBase = new Set(productosIniciales.map(p => p.id));
  let productosAdmin = Array.isArray(productos) ? productos.filter(p => !idsBase.has(p.id)) : [];
  let productosFinal = [...productosIniciales, ...productosAdmin];
  // Si hay productos repetidos (por ejemplo, Air Jordan 4RM), dejamos solo uno
  productosFinal = productosFinal.filter((p, idx, arr) =>
    !(p.nombre === "Air Jordan 4RM" && arr.findIndex(x => x.nombre === "Air Jordan 4RM") !== idx)
  );
  // Si por algún motivo faltan zapatillas base, las restauramos y actualizamos el localStorage
  const nombresBase = productosIniciales.map(p => p.nombre);
  if (!productosFinal.some(p => p.nombre === nombresBase[0]) ||
      !productosFinal.some(p => p.nombre === nombresBase[1]) ||
      !productosFinal.some(p => p.nombre === nombresBase[2])) {
    productosFinal = [...productosIniciales, ...productosAdmin];
    localStorage.setItem("productos", JSON.stringify(productosFinal));
  }
  productos = productosFinal;
}
